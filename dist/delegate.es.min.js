/**
 * @preserve delegate (c) KNOWLEDGECODE | MIT
 */
class e{constructor(e,t){this.originalEvent=e,this.stop=!e.bubbles,this.abort=!1,this.currentTarget=t}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.stop=!0}stopImmediatePropagation(){this.abort=this.stop=!0}}const t=[];class s{constructor(e){return this._baseEventTarget=e,this._eventCache={},this._subscribers={},this}listener(t){let s=this._subscribers[t.type]||[],r=t.target;for(;r.parentNode;){const n=new e(t,r),i=[];for(const e of s)if(e.selector&&r.matches(e.selector)){if(e.handler.call(r,n),n.abort)break}else i[i.length]=e;if(!i.length||n.stop)return;s=i,r=r.parentNode}r=t.currentTarget;const n=new e(t,r);for(const e of s)if(!e.selector&&(e.handler.call(r,n),n.abort))break}on(e,t,s){if("function"==typeof t&&(s=t,t=null),!~Object.keys(this._eventCache).indexOf(e)){const t=this.listener.bind(this);this._baseEventTarget.addEventListener(e,t,!0),this._eventCache[e]=t}return this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push({selector:t,handler:s}),this}off(e,t,s){if("function"==typeof t&&(s=t,t=null),e)if(t||s){const r=[];for(const n of this._subscribers[e])(n.selector!==t||s&&n.handler!==s)&&(r[r.length]=n);r.length?this._subscribers[e]=r:delete this._subscribers[e]}else delete this._subscribers[e];else this._subscribers={};return this}one(e,t,s){const r=this,n=function(i){r.off(e,t||n,n),s.call(this,i)};return"function"==typeof t?(s=t,t=null,this.on(e,n)):this.on(e,t,n)}clear(){this.off();for(const e of Object.keys(this._eventCache))this._baseEventTarget.removeEventListener(e,this._eventCache[e],!0);this._eventCache={};for(let e=0,s=t.length;e<s;e++)if(this._baseEventTarget===t[e].baseEventTarget){t.splice(e,1);break}}}export default e=>{if(!e instanceof EventTarget)throw new TypeError(`${e} is not an EventTarget`);for(const s of t)if(e===s.baseEventTarget)return s.delegator;const r=new s(e);return t.push({baseEventTarget:e,delegator:r}),r};