/**
 * @preserve delegate (c) KNOWLEDGECODE | MIT
 */
let t=[];const e=(t,e)=>{for(let s=0,r=t.length;s<r;s++)if(e(t[s]))return t[s]},s=(t,e)=>{const s=[],r=[];for(let n=0,i=t.length;n<i;n++)e(t[n])?s.push(t[n]):r.push(t[n]);return[s,r]};class r{constructor(t,e){this.originalEvent=t,this.stop=!t.bubbles,this.abort=!1,this.currentTarget=e}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.stop=!0}stopImmediatePropagation(){this.abort=this.stop=!0}}class n{constructor(t){return this._baseEventTarget=t,this._eventCache={},this._subscribers={},this}listener(t){let e=this._subscribers[t.type]||[],n=t.target;for(;(n||{}).parentNode;){const i=new r(t,n),[o,h]=s(e,(e=>s=>e.matches(s.selector)||!s.selector&&e===t.currentTarget)(n));for(let t=0,e=o.length;t<e;t++)if(o[t].handler.call(n,i),i.abort)return;if(e=h,!h.length||i.stop)return;n=n.parentNode}n=t.currentTarget;const i=new r(t,n),[o]=s(e,t=>!t.selector);for(let t=0,e=o.length;t<e;t++)if(o[t].handler.call(n,i),i.abort)return}on(t,s,r){"function"==typeof s&&(r=s,s=null);const n=this._subscribers[t]=this._subscribers[t]||[];if(!e(n,t=>t.selector===s&&t.handler===r)&&(n.push({selector:s,handler:r}),!this._eventCache[t])){const e=this.listener.bind(this);this._eventCache[t]=e,this._baseEventTarget.addEventListener(t,e,!0)}return this}off(t,e,s){return"function"==typeof e&&(s=e,e=null),t?e||s?(this._subscribers[t]=(this._subscribers[t]||[]).filter(t=>t.selector===e&&(!s||t.handler===s)),this._subscribers[t].length||delete this._subscribers[t]):delete this._subscribers[t]:this._subscribers={},this}one(t,e,s){const r=this,n=function(i){r.off(t,e||n,n),s.call(this,i)};return"function"==typeof e?(s=e,e=null,this.on(t,n)):this.on(t,e,n)}clear(){this.off(),((t,e)=>{for(let s=0,r=t.length;s<r;s++)e(t[s])})(Object.keys(this._eventCache),t=>{this._baseEventTarget.removeEventListener(t,this._eventCache[t],!0)}),this._eventCache={},t=t.filter(t=>this._baseEventTarget!==t.baseEventTarget)}}export default s=>{if(!s instanceof EventTarget)throw new TypeError(s+" is not an EventTarget");return(e(t,t=>s===t.baseEventTarget)||(t.push({baseEventTarget:s,delegator:new n(s)}),t.slice(-1)[0])).delegator};
