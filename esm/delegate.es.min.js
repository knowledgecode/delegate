/**
 * @preserve delegate (c) KNOWLEDGECODE | MIT
 */
let t=[];const e=(t,e)=>{for(let s=0,r=t.length;s<r;s++)if(e(t[s]))return t[s]},s=(t,e)=>{for(let s=0,r=t.length;s<r;s++)e(t[s])},r=(t,e)=>{const r=[],n=[];return s(t,t=>e(t)?r.push(t):n.push(t)),[r,n]};class n{constructor(t,e){this.originalEvent=t,this.stop=!t.bubbles,this.abort=!1,this.currentTarget=e}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.stop=!0}stopImmediatePropagation(){this.abort=this.stop=!0}}class i{constructor(t){return this._baseEventTarget=t,this._eventCache={},this._subscribers={},this}listener(t){let e,s=this._subscribers[t.type]||[],i=t.target;if(s.length){for(;(i||{}).parentNode;){if([e,s]=r(s,(e=>s=>e.matches(s.selector)||!s.selector&&e===t.currentTarget)(i)),e.length){const r=new n(t,i);for(let t=0,s=e.length;t<s;t++)if(e[t].handler.call(i,r),r.abort)return;if(!s.length||r.stop)return}i=i.parentNode}if([e]=r(s,t=>!t.selector),e.length){i=t.currentTarget;const s=new n(t,i);for(let t=0,r=e.length;t<r;t++)if(e[t].handler.call(i,s),s.abort)return}}}on(t,s,r){"function"==typeof s&&(r=s,s=null);const n=this._subscribers[t]=this._subscribers[t]||[];if(!e(n,t=>t.selector===s&&t.handler===r)&&(n.push({selector:s,handler:r}),!this._eventCache[t])){const e=this.listener.bind(this);this._eventCache[t]=e,this._baseEventTarget.addEventListener(t,e,!0)}return this}off(t,e,s){return"function"==typeof e&&(s=e,e=null),t?e||s?(this._subscribers[t]=(this._subscribers[t]||[]).filter(t=>t.selector===e&&(!s||t.handler===s)),this._subscribers[t].length||delete this._subscribers[t]):delete this._subscribers[t]:this._subscribers={},this}one(t,e,s){const r=this,n=function(i){r.off(t,e||n,n),s.call(this,i)};return"function"==typeof e?(s=e,e=null,this.on(t,n)):this.on(t,e,n)}clear(){this.off(),s(Object.keys(this._eventCache),t=>{this._baseEventTarget.removeEventListener(t,this._eventCache[t],!0)}),this._eventCache={},t=t.filter(t=>this._baseEventTarget!==t.baseEventTarget)}}export default s=>{if(!s instanceof EventTarget)throw new TypeError(s+" is not an EventTarget");return(e(t,t=>s===t.baseEventTarget)||(t.push({baseEventTarget:s,delegator:new i(s)}),t.slice(-1)[0])).delegator};
