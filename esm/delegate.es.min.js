/**
 * @preserve delegate (c) KNOWLEDGECODE | MIT
 */
Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||Element.prototype.msMatchesSelector);const t=new WeakMap,e=(t,e)=>{for(let s=0,r=t.length;s<r;s++)e(t[s],s)},s=(t,s)=>{const r=[[],[]];return e(t,t=>s(t)?r[0].push(t):r[1].push(t)),r};class r{constructor(t,e){this.originalEvent=t,this.stop=!t.bubbles,this.abort=!1,this.currentTarget=e}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.stop=!0}stopImmediatePropagation(){this.abort=this.stop=!0}}class n{constructor(t){return this._baseEventTarget=t,this._eventCache={},this._subscribers={},this}listener(t){let e,n=this._subscribers[t.type]||[],i=t.target;if(n.length){for(;(i||{}).parentNode;){if([e,n]=s(n,(e=>s=>e.matches(s.selector)||!s.selector&&e===t.currentTarget)(i)),e.length){const s=new r(t,i);for(let t=0,r=e.length;t<r;t++)if(e[t].handler.call(i,s),s.abort)return;if(!n.length||s.stop)return}i=i.parentNode}if([e]=s(n,t=>!t.selector),e.length){i=t.currentTarget;const s=new r(t,i);for(let t=0,r=e.length;t<r;t++)if(e[t].handler.call(i,s),s.abort)return}}}on(t,e,s){"function"==typeof e&&(s=e,e=null);const r=this._subscribers[t]=this._subscribers[t]||[];if(!((t,e)=>{for(let s=0,r=t.length;s<r;s++)if(e(t[s]))return t[s]})(r,t=>t.selector===e&&t.handler===s)&&(r.push({selector:e,handler:s}),!this._eventCache[t])){const e=this.listener.bind(this);this._eventCache[t]=e,this._baseEventTarget.addEventListener(t,e,!0)}return this}off(t,e,s){return"function"==typeof e&&(s=e,e=null),t?e||s?(this._subscribers[t]=(this._subscribers[t]||[]).filter(t=>t.selector===e&&(!s||t.handler===s)),this._subscribers[t].length||delete this._subscribers[t]):delete this._subscribers[t]:this._subscribers={},this}one(t,e,s){const r=this,n=function(i){r.off(t,e||n,n),s.call(this,i)};return"function"==typeof e?(s=e,e=null,this.on(t,n)):this.on(t,e,n)}clear(){this.off(),e(Object.keys(this._eventCache),t=>{this._baseEventTarget.removeEventListener(t,this._eventCache[t],!0)}),this._eventCache={},t.delete(this._baseEventTarget)}}export default e=>{if("function"!=typeof e.addEventListener)throw new TypeError(e+" is not an EventTarget");return t.get(e)||(()=>{const s=new n(e);return t.set(e,s),s})()};
