/*
 delegate (c) KNOWLEDGECODE | MIT
*/
'use strict';(function(e,f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define(f):(e="undefined"!==typeof globalThis?globalThis:e||self,e.date=f())})(this,function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||Element.prototype.msMatchesSelector);let e=new WeakMap,f=(a,b)=>{for(let c=0,d=a.length;c<d;c++)if(b(a[c]))return a[c]},h=(a,b)=>{for(let c=0,d=a.length;c<d;c++)b(a[c],c)},
k=(a,b)=>{const c=[[],[]];h(a,a=>b(a)?c[0].push(a):c[1].push(a));return c};class l{constructor(a,b){this.originalEvent=a;this.stop=!a.bubbles;this.abort=!1;this.currentTarget=b}preventDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.stop=!0}stopImmediatePropagation(){this.abort=this.stop=!0}}class m{constructor(a){this._baseEventTarget=a;this._eventCache={};this._subscribers={};return this}listener(a){var b=this._subscribers[a.type]||[];let c=a.target,d;if(b.length){for(;(c||{}).parentNode;){[d,
b]=k(b,(b=>c=>b.matches(c.selector)||!c.selector&&b===a.currentTarget)(c));if(d.length){let g=new l(a,c);for(let a=0,b=d.length;a<b;a++)if(d[a].handler.call(c,g),g.abort)return;if(!b.length||g.stop)return}c=c.parentNode}[d]=k(b,a=>!a.selector);if(d.length){c=a.currentTarget;b=new l(a,c);for(let a=0,e=d.length;a<e&&(d[a].handler.call(c,b),!b.abort);a++);}}}on(a,b,c){"function"===typeof b&&(c=b,b=null);var d=this._subscribers[a]=this._subscribers[a]||[];f(d,a=>a.selector===b&&a.handler===c)||(d.push({selector:b,
handler:c}),this._eventCache[a]||(d=this.listener.bind(this),this._eventCache[a]=d,this._baseEventTarget.addEventListener(a,d,!0)));return this}off(a,b,c){"function"===typeof b&&(c=b,b=null);a?b||c?(this._subscribers[a]=(this._subscribers[a]||[]).filter(a=>a.selector!==b||c&&a.handler!==c),this._subscribers[a].length||delete this._subscribers[a]):delete this._subscribers[a]:this._subscribers={};return this}one(a,b,c){let d=this,e=function(f){d.off(a,b||e,e);c.call(this,f)};return"function"===typeof b?
(c=b,b=null,this.on(a,e)):this.on(a,b,e)}clear(){this.off();h(Object.keys(this._eventCache),a=>{this._baseEventTarget.removeEventListener(a,this._eventCache[a],!0)});this._eventCache={};e.delete(this._baseEventTarget)}}return a=>{if("function"!==typeof a.addEventListener)throw new TypeError(`${a} is not an EventTarget`);var b;(b=e.get(a))||(b=new m(a),e.set(a,b));return b}})
